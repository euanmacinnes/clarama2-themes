{% set tab_id = tab.tab_id if tab.tab_id is defined else (tab_id if tab_id is defined else loop.index0) %}
{% set source = tab.source if tab.source is defined else (source if source is defined else '') %}
{% set has_source = source and source.strip() %}
{% set filename = source.split('/')[-1].split('\\')[-1] if has_source else 'Tab ' + (tab_id|string) %}
{% set is_active = is_active if is_active is defined else (current_loop.first if current_loop is defined else false) %}

<li class="nav-item" role="presentation">
    <button class="nav-link tab-item source-tab {% if is_active %}active{% endif %}"
            id="tab_{{ loop_index }}_{{ tab_id }}"
            data-bs-toggle="tab"
            data-bs-target="#tabContentBlock_{{ loop_index }}_{{ tab_id }}"
            type="button" role="tab"
            aria-controls="tabContentBlock_{{ loop_index }}_{{ tab_id }}"
            aria-selected="{% if is_active %}true{% else %}false{% endif %}"
            title="{{ filename }}">
        <span class="tab-title">{{ filename }}</span>
        <i class="bi bi-x-lg ms-2 close-tab" title="Close tab" style="cursor: pointer;"></i>
    </button>
</li>